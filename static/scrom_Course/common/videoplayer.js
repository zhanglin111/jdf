var makeVideoPlayableInline=function(){"use strict";function e(e,t,i,n){function r(i){a=t(r,n),e(i-(o||i)),o=i}var a,o;return{start:function(){a||r(0)},stop:function(){i(a),a=null,o=0}}}function t(t){return e(t,requestAnimationFrame,cancelAnimationFrame)}function i(e,t,i,n){function r(t){Boolean(e[i])===Boolean(n)&&t.stopImmediatePropagation(),delete e[i]}return e.addEventListener(t,r,!1),r}function n(e,t,i,n){function r(){return i[t]}function a(e){i[t]=e}n&&a(e[t]),Object.defineProperty(e,t,{get:r,set:a})}function r(e,t,i){i.addEventListener(t,function(){return e.dispatchEvent(new Event(t))})}function a(e,t){Promise.resolve().then(function(){e.dispatchEvent(new Event(t))})}function o(e){var t=new Audio;return r(e,"play",t),r(e,"playing",t),r(e,"pause",t),t.crossOrigin=e.crossOrigin,t.src=e.src||e.currentSrc||"data:",t}function s(e,t,i){(v||0)+200<Date.now()&&(e[g]=!0,v=Date.now()),i||(e.currentTime=t),T[++w%3]=100*t|0}function d(e){return e.driver.currentTime>=e.video.duration}function p(e){var t=this;t.video.readyState>=t.video.HAVE_FUTURE_DATA?(t.hasAudio||(t.driver.currentTime=t.video.currentTime+e*t.video.playbackRate/1e3,t.video.loop&&d(t)&&(t.driver.currentTime=0)),s(t.video,t.driver.currentTime)):t.video.networkState!==t.video.NETWORK_IDLE||t.video.buffered.length||t.video.load(),t.video.ended&&(delete t.video[g],t.video.pause(!0))}function l(){var e=this,t=e[b];return e.webkitDisplayingFullscreen?void e[E]():("data:"!==t.driver.src&&t.driver.src!==e.src&&(s(e,0,!0),t.driver.src=e.src),void(e.paused&&(t.paused=!1,e.buffered.length||e.load(),t.driver.play(),t.updater.start(),t.hasAudio||(a(e,"play"),t.video.readyState>=t.video.HAVE_ENOUGH_DATA&&a(e,"playing")))))}function u(e){var t=this,i=t[b];i.driver.pause(),i.updater.stop(),t.webkitDisplayingFullscreen&&t[P](),i.paused&&!e||(i.paused=!0,i.hasAudio||a(t,"pause"),t.ended&&(t[g]=!0,a(t,"ended")))}function c(e,i){var n=e[b]={};n.paused=!0,n.hasAudio=i,n.video=e,n.updater=t(p.bind(n)),i?n.driver=o(e):(e.addEventListener("canplay",function(){e.paused||a(e,"playing")}),n.driver={src:e.src||e.currentSrc||"data:",muted:!0,paused:!0,pause:function(){n.driver.paused=!0},play:function(){n.driver.paused=!1,d(n)&&s(e,0)},get ended(){return d(n)}}),e.addEventListener("emptied",function(){var t=!n.driver.src||"data:"===n.driver.src;n.driver.src&&n.driver.src!==e.src&&(s(e,0,!0),n.driver.src=e.src,t?n.driver.play():n.updater.stop())},!1),e.addEventListener("webkitbeginfullscreen",function(){e.paused?i&&!n.driver.buffered.length&&n.driver.load():(e.pause(),e[E]())}),i&&(e.addEventListener("webkitendfullscreen",function(){n.driver.currentTime=e.currentTime}),e.addEventListener("seeking",function(){T.indexOf(100*e.currentTime|0)<0&&(n.driver.currentTime=e.currentTime)}))}function h(e){var t=e[b];e[E]=e.play,e[P]=e.pause,e.play=l,e.pause=u,n(e,"paused",t.driver),n(e,"muted",t.driver,!0),n(e,"playbackRate",t.driver,!0),n(e,"ended",t.driver),n(e,"loop",t.driver,!0),i(e,"seeking"),i(e,"seeked"),i(e,"timeupdate",g,!1),i(e,"ended",g,!1)}function y(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!0),i&&!m||e[b]||(c(e,t),h(e),e.classList.add("IIV"),!t&&e.autoplay&&e.play(),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments"))}var v,f="undefined"==typeof Symbol?function(e){return"@"+(e||"@")+Math.random()}:Symbol,m=/iPhone|iPod/i.test(navigator.userAgent)&&!matchMedia("(-webkit-video-playable-inline)").matches,b=f(),g=f(),E=f("nativeplay"),P=f("nativepause"),T=[],w=0;return y.isWhitelisted=m,y}();!function(){function e(){this.url=null,this.isPlaying=!1,this.volume=1,this.canplay=!1,this.container=null,this.player=null,this.onLoadedmetadata=null,this.onPlay=null,this.onPause=null,this.onUpdate=null,this.onEnded=null}var t=null;e.prototype.init=function(e){this.container=e.container||document.body,this.player=document.createElement("video"),this.container.appendChild(this.player);var t=this.player.style;t.position="absolute",t.top=e.top||0,t.left=e.left||0,t.width=e.width||"1px",t.height=e.height||"1px",t.zIndex=e.zIndex||"998",t.display="inline",this.player.setAttribute("webkit-playsinline",!0),this.player.setAttribute("playsinline",!0),makeVideoPlayableInline(this.player);var i=document.createElement("style");i.type="text/css",i.textContent=".IIV::-webkit-media-controls-play-button,.IIV::-webkit-media-controls-start-playback-button {opacity: 0;pointer-events: none;width: 5px;}",document.body.appendChild(i),e.poster&&(this.isAndroid()?this.setPoster(e.poster):this.player.setAttribute("poster",e.poster)),e.controls&&this.player.setAttribute("controls",!0),e.url&&this.setUrl(e.url),this._handleEvents()},e.prototype.isAndroid=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1},e.prototype.setPoster=function(e){var t=document.createElement("img");this.container.appendChild(t),t.src=e;var i=t.style;i.position="absolute",i.top=0,i.left=0,i.width="100%",i.height="100%",i.zIndex=999,this.poster=t},e.prototype.setPosterVisible=function(e){this.poster.style.display=e?"block":"none"},e.prototype._handleEvents=function(){this.player.addEventListener("play",this._playHandler.bind(this),!1),this.player.addEventListener("pause",this._pauseHandler.bind(this),!1),this.player.addEventListener("ended",this._playEndHandler.bind(this),!1),this.player.addEventListener("error",this._playErrorHandler.bind(this),!1),this.player.addEventListener("durationchange",this._durationChangeHandler.bind(this),!1),this.player.addEventListener("timeupdate",this._timeUpdateHandler.bind(this),!1),this.player.addEventListener("loadedmetadata",this._onLoadedmetadata.bind(this),!1),this.player.addEventListener("canplaythrough",this._canplayHandle.bind(this),!1),this.player.addEventListener("loadeddata",this._test.bind(this),!1)},e.prototype._test=function(e){},e.prototype._playHandler=function(e){this.onPlay&&this.onPlay(this.player.currentTime,this.player.duration)},e.prototype._pauseHandler=function(e){this.onPause&&this.onPause(this.player.currentTime,this.player.duration)},e.prototype._playEndHandler=function(e){this.isPlaying=!1,this.onEnded&&this.onEnded(this.player.currentTime,this.player.duration)},e.prototype._onLoadedmetadata=function(e){this.onLoadedmetadata&&this.onLoadedmetadata(0,this.player.duration)},e.prototype._durationChangeHandler=function(e){if(this.onDurationChange){var t=this.player.duration,i=this.player.currentTime||0;this.onDurationChange(i,t)}},e.prototype._timeUpdateHandler=function(e){if(this.onUpdate&&this.isPlaying){var t=this.player.duration,i=this.player.currentTime;this.onUpdate(i,t),this.poster&&this.player&&this.player.currentTime>0&&this.setPosterVisible(!1)}},e.prototype._canplayHandle=function(e){this.canplay=!0},e.prototype._playErrorHandler=function(e){alert("播放错误! code: "+e.target.error.code)},e.prototype.getDuration=function(){return this.player&&this.player.duration>0?this.player.duration:0},e.prototype.setUrl=function(e){this.url=e,this.player&&e&&(this.player.src=e)},e.prototype.play=function(){this.url&&(this.isPlaying=!0,this.player.play())},e.prototype.stop=function(){this.pause(),this.player.currentTime=0},e.prototype.resume=function(){this.play()},e.prototype.pause=function(){this.isPlaying=!1,this.player.pause()},e.prototype.seekTo=function(e){this.player.currentTime=e},e.prototype.seekToPercent=function(e){this.player.currentTime=this.player.duration*e},e.prototype.setVolume=function(e){this.player&&(this.player.volume=e,this.volume=e)},e.prototype.show=function(){this.player&&(this.player.style.display="block")},e.prototype.hide=function(){this.player&&(this.player.style.display="none")},e.getInstance=function(){return t||(t=new e),t},e.version="0.1.5",t=e.getInstance(),window.videoplayer=t}();