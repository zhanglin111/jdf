function setUpTitle(e){jq("video-title").innerText=e}function getCourseData(){var e=get_suspend_data(),t=get_lesson_status(),n="completed"==t;return e?(e[course_name][VIDEO_COMPLETE]=n,e[course_name]):(e={},e[course_name]={},e[course_name][VIDEO_MAX_TIME]=0,e[course_name][VIDEO_PLAY_TIME]=0,e[course_name][VIDEO_COMPLETE]=n,set_suspend_data(e),null)}function setCourseData(e){var t=get_suspend_data();t[course_name]=e,set_suspend_data(t)}function convertToJSON(e){var t=e.split(SPLIT_SYMBOL);if(t.length<3)return null;var n={};return n[course_name]={},n[course_name][VIDEO_MAX_TIME]=t[0],n[course_name][VIDEO_PLAY_TIME]=t[1],n[course_name][VIDEO_COMPLETE]=0!=t[2],n}function convertToPlainString(e){var t=e[course_name],n=t[VIDEO_COMPLETE]?1:0;return t[VIDEO_MAX_TIME]+SPLIT_SYMBOL+t[VIDEO_PLAY_TIME]+SPLIT_SYMBOL+n}function checkVideoStatus(){var e=getCourseData();if(e){if(void 0!==e[VIDEO_COMPLETE]){var t=e[VIDEO_COMPLETE]?e[VIDEO_PLAY_TIME]:e[VIDEO_MAX_TIME],n=parseInt(videoplayer.getDuration());t!=n&&0!=t||(t=.01),resumeVideoFromTime(t)}}else updateVideoStatus(0,!1),resumeVideoFromTime(.01)}function updateVideoStatus(e,t){var n=getCourseData();n||(n={}),void 0!==t&&(n[VIDEO_COMPLETE]=t),void 0!==n[VIDEO_MAX_TIME]?n[VIDEO_MAX_TIME]<e&&(n[VIDEO_MAX_TIME]=e):n[VIDEO_MAX_TIME]=e,n[VIDEO_PLAY_TIME]=e,setCourseData(n)}function jq(e){return document.getElementById(e)}function setButtonStatus(e){switch(e){case"pause":btn.className="btn-play play";break;case"play":btn.className="btn-play pause"}btn.setAttribute("data-val",e)}function getButtonStatus(){return btn.getAttribute("data-val")}function setProgressPercent(e){bar.style.width=100*e+"%"}function formatTime(e){var t=parseInt(e),n=Math.floor(t/60),o=t-60*n;return n<10&&(n="0"+n),o<10&&(o="0"+o),n+":"+o}function resumeVideoFromTime(e){if(!(e<=0)){var t=videoplayer.getDuration();videoplayer.play(),videoplayer.seekTo(e),t<.5||e>t||(tCurrent.innerText=formatTime(e),tDuration.innerText=formatTime(t),setProgressPercent(e/t))}}function onVideoMetadataLoaded(e,t){tCurrent.innerText=formatTime(e),tDuration.innerText=formatTime(t),checkVideoStatus()}function onVideoUpdate(e,t){tCurrent.innerText=formatTime(e),tDuration.innerText=formatTime(t),setProgressPercent(e/t),updateVideoStatus(parseInt(e)),e>0&&!is_resume&&(is_resume=!0)}function onVideoEnd(e,t){setButtonStatus("pause"),updateVideoStatus(parseInt(e),!0),set_lesson_current_complete()}function onVideoPlay(e,t){setButtonStatus("play")}function onVideoPause(e,t){setButtonStatus("pause")}var box,btn,bar,progress,tCurrent,tDuration,course_name,VIDEO_MAX_TIME="max",VIDEO_PLAY_TIME="time",VIDEO_COMPLETE="played",SPLIT_SYMBOL=",",is_resume=!1;window.onload=function(){course_name=config[courseIndex-1].id,do_load_page(),setUpTitle(config[courseIndex-1].title),box=jq("video-box"),btn=jq("btn-play"),progress=jq("v-progress-container"),bar=jq("v-progress-current"),tCurrent=jq("v-time-current"),tDuration=jq("v-time-duration"),videoplayer.init({url:config[courseIndex-1].video,container:document.getElementById("video-content"),top:0,left:0,width:"100%",height:"calc(100% - 30px)"}),videoplayer.onLoadedmetadata=onVideoMetadataLoaded,videoplayer.onUpdate=onVideoUpdate,videoplayer.onEnded=onVideoEnd,videoplayer.onPlay=onVideoPlay,videoplayer.onPause=onVideoPause,setButtonStatus("pause"),btn.onclick=function(e){if(!is_resume)return void checkVideoStatus();"pause"==getButtonStatus()?videoplayer.play():videoplayer.pause()},progress.addEventListener("click",function(e){var t=e.currentTarget.clientWidth,n=e.offsetX,o=n/t,a=getCourseData(),r=a[VIDEO_MAX_TIME],i=a[VIDEO_COMPLETE],u=videoplayer.getDuration(),s=parseInt(o*u);(i||r&&s&&!(s>r))&&(setProgressPercent(o),videoplayer.seekToPercent(o),tCurrent.innerText=formatTime(s),tDuration.innerText=formatTime(u))},!1)},window.onunload=function(){do_quit_page()},window.oncontextmenu=function(){return!1};